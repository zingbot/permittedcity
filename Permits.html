<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
  <title>Starting Point v1</title>
  <link rel="stylesheet" href="http://libs.cartocdn.com/cartodb.js/v3/themes/css/cartodb.css" />
   <script src="http://code.jquery.com/jquery-1.10.1.min.js" type="text/javascript"></script>
   <script src="http://libs.cartocdn.com/cartodb.js/v3/cartodb.js"></script>
	 <link rel="stylesheet" href="http://cdn.leafletjs.com/leaflet-0.6.2/leaflet.css" />
 <!--[if lte IE 8]>
     <link rel="stylesheet" href="http://cdn.leafletjs.com/leaflet-0.6.2/leaflet.ie.css" />
 <![endif]--> 
<style>body,html {width:100%; height:100%; margin:0; padding:0; } #map {height:100%;}</style> 
   </head>
  <body onload="initialize()">
  <div id="map"></div>
  
  <script>

  	var map; 
  	function initialize() {
	  	/*   this is where the zoom and lat/long is set */
	  	map = new L.Map('map').setView(new L.LatLng(40.698, -73.97), 11);
	  	
var mapboxUrl = 'http://{s}.tiles.mapbox.com/v3/zingbot.map-nzrryjpo/{z}/{x}/{y}.png'
        , mapbox = new L.TileLayer(mapboxUrl, {maxZoom: 18, attribution: "Powered by Leaflet and Mapbox"});
		map.addLayer(mapbox,true);

    
    cartodb.createLayer(map, 'http://zingbot.cartodb.com/api/v2/viz/cccc95c4-f951-11e2-a729-5404a6a69006/viz.json')
        .addTo(map)
		.on('done', function(layer) {
          	layer.setInteraction(true); 

		  	var sublayer = layer.getSubLayer(0);
		  	sublayer.set({
		  		interactivity: "cartodb_id, the_geom,job___"
		  	}
		  		);
		  	sublayer.on('featureClick', function(e, latlng, pos, data, layerindex) {
		  		console.log(data);
		  		$.getJSON("http://zingbot.cartodb.com/api/v2/sql?q=SELECT%20bin___,job___,job_type_%20FROM%20per2008geo_al%20WHERE%20job___='" + data.job___ + "'", function(data) {console.log(data)});
		  		})
		 
    /*
layer.on('featureClick', function(e, latlng, pos, data, layerindex) {
     map.setView( latlng, map.getMaxZoom()); 
    	cartodb.log.log(e, pos, latlng, data, layerindex);
console.log(e);  	
    	console.log(latlng);
    	console.log(pos);
    	console.log(data);
    	console.log(layerindex);

 			});
 */			
		});
}
      
</script>
      
  </body>
</html>